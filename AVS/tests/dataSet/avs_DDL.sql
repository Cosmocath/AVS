-- MySQL Script generated by MySQL Workbench
-- Mon Aug 26 10:06:02 2019
-- Model: New Model    Version: 2.0
-- MySQL Workbench Forward Engineering

SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0;
SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0;
SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION';

-- -----------------------------------------------------
-- suppression base avs
-- -----------------------------------------------------
DROP DATABASE IF EXISTS `avs` ;


-- -----------------------------------------------------
-- Database avs
-- -----------------------------------------------------
CREATE DATABASE IF NOT EXISTS `avs` DEFAULT CHARACTER SET utf16 COLLATE utf16_general_ci;

USE `avs` ;

-- -----------------------------------------------------
-- Table `avs`.`Profil`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`Profil` ;

CREATE TABLE IF NOT EXISTS `avs`.`Profil` (
  `id_Profil` INT NOT NULL,
  `nom` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id_Profil`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `avs`.`Droit`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`Droit` ;

CREATE TABLE IF NOT EXISTS `avs`.`Droit` (
  `id_Droit` INT NOT NULL,
  `url` VARCHAR(255) NOT NULL,
  `description` VARCHAR(255) NOT NULL,
  PRIMARY KEY (`id_Droit`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `avs`.`Utilisateur`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`Utilisateur` ;

CREATE TABLE IF NOT EXISTS `avs`.`Utilisateur` (
  `id_Utilisateur` INT NOT NULL,
  `nom` VARCHAR(255) NOT NULL,
  `prenom` VARCHAR(255) NOT NULL,
  `date_naissance` DATE NOT NULL,
  `adresse` VARCHAR(255) NOT NULL,
  `mail` VARCHAR(255) NOT NULL,
  `password` VARCHAR(255) NOT NULL,
  `actif` BIT(1) NOT NULL,
  `id_Profil` INT NOT NULL,
  PRIMARY KEY (`id_Utilisateur`),
  INDEX `fk_Utilisateur_Profil1_idx` (`id_Profil` ASC),
  CONSTRAINT `fk_Utilisateur_Profil1`
    FOREIGN KEY (`id_Profil`)
    REFERENCES `avs`.`Profil` (`id_Profil`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `avs`.`Commande`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`Commande` ;

CREATE TABLE IF NOT EXISTS `avs`.`Commande` (
  `id_Commande` INT NOT NULL,
  `id_Utilisateur` INT NULL,
  `nom` VARCHAR(255) NOT NULL,
  `adresse_livraison` VARCHAR(255) NOT NULL,
  `adresse_facturation` VARCHAR(255) NOT NULL,  
  `numero_commande` VARCHAR(255) NOT NULL,
  `date_commande` DATE NOT NULL,
  `montant_sans_remise` FLOAT NOT NULL,
  `remise` FLOAT NOT NULL,
  PRIMARY KEY (`id_Commande`),
  INDEX `fk_Commande_Utilisateur1_idx` (`id_Utilisateur` ASC) ,
  CONSTRAINT `fk_Commande_Utilisateur1`
    FOREIGN KEY (`id_Utilisateur`)
    REFERENCES `avs`.`Utilisateur` (`id_Utilisateur`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `avs`.`ProduitVendu`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`ProduitVendu` ;

CREATE TABLE IF NOT EXISTS `avs`.`ProduitVendu` (
  `id_ProduitVendu` INT NOT NULL,
  `designation` VARCHAR(255) NOT NULL,
  `reference` INT NOT NULL,
  `description` VARCHAR(255) NOT NULL,
  `prix` FLOAT NOT NULL,
  `image` VARCHAR(255) NOT NULL,
  `numero_version` INT NOT NULL,
  `id_Produit_Historise` INT NOT NULL,
  PRIMARY KEY (`id_ProduitVendu`))
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `avs`.`Produit`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`Produit` ;

CREATE TABLE IF NOT EXISTS `avs`.`Produit` (
  `id_Produit` INT NOT NULL,
  `designation` VARCHAR(255) NOT NULL,
  `reference` INT NOT NULL,
  `description` VARCHAR(255) NOT NULL,
  `prix` FLOAT NOT NULL,
  `image` VARCHAR(255) NOT NULL,
  `numero_version` INT NOT NULL,
  `actif` BIT(1) NOT NULL,
  PRIMARY KEY (`id_Produit`))
ENGINE = InnoDB;



-- -----------------------------------------------------
-- Table `avs`.`CommandeProduit`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`CommandeProduit` ;

CREATE TABLE IF NOT EXISTS `avs`.`CommandeProduit` (
  `id_CommandeProduit` INT NOT NULL,
  `idCommande` INT NOT NULL,
  `id_ProduitVendu` INT NOT NULL,
  `quantite` INT NOT NULL,
  PRIMARY KEY (`id_CommandeProduit`, `idCommande`, `id_ProduitVendu`),
  INDEX `fk_CommandeProduit_Commande1_idx` (`idCommande` ASC) ,
  INDEX `fk_CommandeProduit_ProduitVendu1_idx` (`id_ProduitVendu` ASC) ,
  CONSTRAINT `fk_CommandeProduit_Commande1`
    FOREIGN KEY (`idCommande`)
    REFERENCES `avs`.`Commande` (`id_Commande`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_CommandeProduit_ProduitVendu1`
    FOREIGN KEY (`id_ProduitVendu`)
    REFERENCES `avs`.`ProduitVendu` (`id_ProduitVendu`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


-- -----------------------------------------------------
-- Table `avs`.`ProfilDroit`
-- -----------------------------------------------------
DROP TABLE IF EXISTS `avs`.`ProfilDroit` ;

CREATE TABLE IF NOT EXISTS `avs`.`ProfilDroit` (
  `id_ProfilDroit` INT NOT NULL,
  `id_Profil` INT NOT NULL,
  `id_Droit` INT NOT NULL,
  PRIMARY KEY (`id_ProfilDroit`),
  INDEX `fk_Profil_has_Droit_Droit1_idx` (`id_Droit` ASC) ,
  INDEX `fk_Profil_has_Droit_Profil1_idx` (`id_Profil` ASC) ,
  CONSTRAINT `fk_Profil_has_Droit_Profil1`
    FOREIGN KEY (`id_Profil`)
    REFERENCES `avs`.`Profil` (`id_Profil`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `fk_Profil_has_Droit_Droit1`
    FOREIGN KEY (`id_Droit`)
    REFERENCES `avs`.`Droit` (`id_Droit`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION)
ENGINE = InnoDB;


